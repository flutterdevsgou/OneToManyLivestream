# ğŸ“¡ Stream App (React + WebSocket + FFmpeg + HLS)

A fully custom, self-hosted live streaming solution with React frontend and Node.js backend, using FFmpeg and HLS (no external services). Supports live camera streaming, multi-quality playback, and per-stream live chat.

---

## ğŸ“ Project Structure

```
stream-app/
â”œâ”€â”€ client/                     # React frontend
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ HostStream.js   # Host camera + send stream via WebSocket
â”‚   â”‚   â”‚   â”œâ”€â”€ ViewerPlayer.js # Video player with HLS and chat integration
â”‚   â”‚   â”‚   â””â”€â”€ ChatBox.js      # Per-stream chat UI using WebSocket
â”‚   â”‚   â””â”€â”€ App.js              # Routes between Host/Viewer
â”‚   â””â”€â”€ public/
â”‚       â””â”€â”€ index.html          # React mount point
â”‚
â”œâ”€â”€ server/                     # Backend
â”‚   â”œâ”€â”€ stream-server.js        # WebSocket server to pipe MediaRecorder -> FFmpeg
â”‚   â”œâ”€â”€ chat-server.js          # WebSocket chat server with per-stream rooms
â”‚   â””â”€â”€ public/hls/             # HLS output (.m3u8 + .ts files generated by FFmpeg)
â”‚
â”œâ”€â”€ nginx.conf                  # RTMP + HLS server configuration (optional for advanced setups)
â”œâ”€â”€ package.json                # Dependencies for backend services
â””â”€â”€ README.md                   # Project instructions
```

---

## ğŸš€ Features

* ğŸ¥ Host live stream from camera using browser (MediaRecorder + WebSocket)
* ğŸ–¥ï¸ Viewer page with adaptive HLS playback (`hls.js`)
* ğŸ’¬ Live chat per stream using WebSocket
* ğŸ” Multi-quality video (480p, 720p, 1080p) via FFmpeg
* ğŸ” Stream-based routing by ID (e.g. `/watch/stream123`)

---

## ğŸ› ï¸ Technologies Used

* **Frontend**: React, hls.js, WebSocket
* **Backend**: Node.js, FFmpeg, Express (for static files)
* **Streaming**: HLS (`.m3u8` via FFmpeg), optional RTMP server via Nginx

---

## ğŸ§ª Development Workflow

1. Run the WebSocket + FFmpeg server:

   ```bash
   node server/stream-server.js
   node server/chat-server.js
   ```

2. Start React frontend:

   ```bash
   cd client && npm install && npm start
   ```

3. Visit:

   * `http://localhost:3000/host` â€“ Host camera stream
   * `http://localhost:3000/watch/stream123` â€“ Viewer with chat

---

## ğŸ“¦ FFmpeg Sample (for multiple quality outputs)

Use `ffmpeg` with `-var_stream_map` and `-master_pl_name` to generate HLS:

```bash
ffmpeg -re -i pipe:0 \
  -map 0:v -map 0:a -s:v:0 640x360 -b:v:0 800k \
  -map 0:v -map 0:a -s:v:1 1280x720 -b:v:1 2500k \
  -c:v libx264 -c:a aac \
  -f hls -hls_time 4 -hls_list_size 6 \
  -hls_segment_filename "server/public/hls/v%v/segment%d.ts" \
  -master_pl_name master.m3u8 \
  -var_stream_map "v:0,a:0 v:1,a:1" \
  server/public/hls/v%v/stream.m3u8
```

---

## ğŸ“º Playback Example

Use `hls.js` in the viewer component to load the stream:

```js
hls.loadSource('http://localhost:3001/hls/master.m3u8');
hls.attachMedia(videoRef);
```

---

## âœ… To-Do / Improvements

* [ ] Add auth/token protection per stream
* [ ] Add recording option
* [ ] Add moderator/admin UI for chat
* [ ] Add viewer count per stream

---

## ğŸ“¬ Questions?

Open an issue or message the maintainer.

---

MIT License Â© 2025
